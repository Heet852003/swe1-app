container_commands:
  01_remove_old_db:
    command: "rm -f /tmp/db.sqlite3 || true"
    leader_only: true

  02_migrate:
    command: "python manage.py migrate --noinput"
    leader_only: true

  03_fix_permissions:
    command: "chmod 666 /tmp/db.sqlite3 || true"
    leader_only: true

  04_seed_data:
    command: >
      python manage.py shell -c "
      from polls.models import Question, Choice;
      from django.utils import timezone;
      q = Question.objects.create(
          question_text='Are you enjoying this Django app?',
          pub_date=timezone.now()
      );
      q.choice_set.create(choice_text='Yes', votes=0);
      q.choice_set.create(choice_text='No', votes=0);
      "
    leader_only: true
