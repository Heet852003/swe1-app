container_commands:
  01_migrate:
    command: "python manage.py migrate --noinput"
    leader_only: true

  02_permissions:
    command: "chmod 666 /tmp/db.sqlite3 || true"
    leader_only: true

  03_seed_data:
    command: |
      python manage.py shell -c "
from polls.models import Question, Choice
from django.utils import timezone
if not Question.objects.exists():
    q = Question.objects.create(question_text='Are you enjoying this Django app?', pub_date=timezone.now())
    Choice.objects.create(question=q, choice_text='Yes', votes=0)
    Choice.objects.create(question=q, choice_text='No', votes=0)
"
    leader_only: true
